openapi: 3.0.0

servers:
  - description: ""
    url: 'http://127.0.0.1:8080/api/v1'
    
info:
  title: OSS NB API
  description: OSS NB API. 
  version: 1.0.0

tags:
  - name: 'App packages'
    description: Management operations of App descriptors and packages
  - name: 'App instances'
    description: Management operations of NS instances
  - name: 'VIM'
    description: Management operations of VIM

paths:

#BEGIN APP PACKAGES
  '/oss/v1/app_pkgs':
    get:
      tags:
        - "App packages"
      summary: Query information about multiple App package resources
      description: Query information about multiple App package resources
      operationId: list_app_pkgs
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ArrayOfAppPkgInfo'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '405':
          $ref: '#/components/responses/MethodNotAllowed'
        '406':
          $ref: '#/components/responses/NotAcceptable'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/UnprocessableEntity'
        '500':
          $ref: '#/components/responses/InternalServerError'
        '503':
          $ref: '#/components/responses/ServiceUnavailable'
        '5XX':
          $ref: '#/components/responses/UnexpectedError'
        default:
          $ref: '#/components/responses/UnexpectedError'
          
    post:
      tags:
        - "App packages"
      summary: Create a new App Package
      description: Create a new App Package
      operationId: new_app_pkg
      requestBody:
        $ref: '#/components/requestBodies/AppPkgCreation'
      responses:
        '201':
          description: Created
          headers:
            Location:
              schema:
                type: string
                format: uri
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ObjectId'
              example:
                id: "string"
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '405':
          $ref: '#/components/responses/MethodNotAllowed'
        '406':
          $ref: '#/components/responses/NotAcceptable'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/UnprocessableEntity'
        '500':
          $ref: '#/components/responses/InternalServerError'
        '503':
          $ref: '#/components/responses/ServiceUnavailable'
        '5XX':
          $ref: '#/components/responses/UnexpectedError'
        default:
          $ref: '#/components/responses/UnexpectedError'
          

  '/oss/v1/app_pkgs/{app_pkg_id}':
    parameters:
      - name: app_pkg_id
        in: path
        required: true
        description: App Package ID
        schema:
          type: string
    get:
      tags:
        - "App packages"
      summary: Read information about an individual App package resource
      description: Read information about an individual App package resource
      operationId: get_app_pkg
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AppPkgInfo'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '405':
          $ref: '#/components/responses/MethodNotAllowed'
        '406':
          $ref: '#/components/responses/NotAcceptable'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/UnprocessableEntity'
        '500':
          $ref: '#/components/responses/InternalServerError'
        '503':
          $ref: '#/components/responses/ServiceUnavailable'
        '5XX':
          $ref: '#/components/responses/UnexpectedError'
        default:
          $ref: '#/components/responses/UnexpectedError'
          
    delete:
      tags:
        - "App packages"
      summary: Delete an individual App package resource
      description: Delete an individual App package resource
      operationId: delete_app_pkg
      responses:
        '204':
          description: No Content
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '405':
          $ref: '#/components/responses/MethodNotAllowed'
        '406':
          $ref: '#/components/responses/NotAcceptable'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/UnprocessableEntity'
        '500':
          $ref: '#/components/responses/InternalServerError'
        '503':
          $ref: '#/components/responses/ServiceUnavailable'
        '5XX':
          $ref: '#/components/responses/UnexpectedError'
        default:
          $ref: '#/components/responses/UnexpectedError'
          
    patch:
      tags:
        - "App packages"
      summary: Modify an individual App package resource
      description: Modify an individual App package resource
      operationId: update_app_pkg
      requestBody:
        $ref: '#/components/requestBodies/AppPkgUpdate'
      responses:
        '204':
          description: No Content
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '405':
          $ref: '#/components/responses/MethodNotAllowed'
        '406':
          $ref: '#/components/responses/NotAcceptable'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/UnprocessableEntity'
        '500':
          $ref: '#/components/responses/InternalServerError'
        '503':
          $ref: '#/components/responses/ServiceUnavailable'
        '5XX':
          $ref: '#/components/responses/UnexpectedError'
        default:
          $ref: '#/components/responses/UnexpectedError'
          
  '/oss/v1/app_pkgs/{app_pkg_id}/instantiate':
    parameters:
        - name: app_pkg_id
          in: path
          required: true
          description: App Package ID
          schema:
            type: string
    post:
      tags:
        - "App packages"
      summary: Instantiate an App Package
      description: Instantiate an App Package
      operationId: instantiate_app_pkg
      requestBody:
        $ref: '#/components/requestBodies/AppPkgInstantiation'
      responses:
        '201':
          description: Created
          headers:
            Location:
              schema:
                type: string
                format: uri
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ObjectId'
              example:
                id: "string"
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '405':
          $ref: '#/components/responses/MethodNotAllowed'
        '406':
          $ref: '#/components/responses/NotAcceptable'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/UnprocessableEntity'
        '500':
          $ref: '#/components/responses/InternalServerError'
        '503':
          $ref: '#/components/responses/ServiceUnavailable'
        '5XX':
          $ref: '#/components/responses/UnexpectedError'
        default:
          $ref: '#/components/responses/UnexpectedError'  
            
            
#BEGIN APP INSTANCES
  '/oss/v1/appis':
    get:
      tags:
        - "App instances"
      summary: Query information about multiple App instances resources
      description: Query information about multiple App instances resources
      operationId: list_appis
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ArrayOfAppInstancesInfo'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '405':
          $ref: '#/components/responses/MethodNotAllowed'
        '406':
          $ref: '#/components/responses/NotAcceptable'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/UnprocessableEntity'
        '500':
          $ref: '#/components/responses/InternalServerError'
        '503':
          $ref: '#/components/responses/ServiceUnavailable'
        '5XX':
          $ref: '#/components/responses/UnexpectedError'
        default:
          $ref: '#/components/responses/UnexpectedError'


  '/oss/v1/appis/{appi_id}':
    parameters:
      - name: appi_id
        in: path
        required: true
        description: App Instance ID
        schema:
          type: string
    get:
      tags:
        - "App instances"
      summary: Read information about an individual App instance resource
      description: Read information about an individual App instance resource
      operationId: get_appi
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AppInstanceInfo'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '405':
          $ref: '#/components/responses/MethodNotAllowed'
        '406':
          $ref: '#/components/responses/NotAcceptable'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/UnprocessableEntity'
        '500':
          $ref: '#/components/responses/InternalServerError'
        '503':
          $ref: '#/components/responses/ServiceUnavailable'
        '5XX':
          $ref: '#/components/responses/UnexpectedError'
        default:
          $ref: '#/components/responses/UnexpectedError'
          
    delete:
      tags:
        - "App instances"
      summary: Terminate an individual App instance resource
      description: Terminate an individual App instance resource
      operationId: terminate_appi
      responses:
        '204':
          description: No Content
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '405':
          $ref: '#/components/responses/MethodNotAllowed'
        '406':
          $ref: '#/components/responses/NotAcceptable'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/UnprocessableEntity'
        '500':
          $ref: '#/components/responses/InternalServerError'
        '503':
          $ref: '#/components/responses/ServiceUnavailable'
        '5XX':
          $ref: '#/components/responses/UnexpectedError'
        default:
          $ref: '#/components/responses/UnexpectedError'
          
#BEGIN VIM  
  '/oss/v1/vims':
    get:
      tags:
        - "VIM"
      summary: Query information about multiple VIMs
      description: Query information about multiple VIMs
      operationId: list_vims
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ArrayOfVimsInfo'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '405':
          $ref: '#/components/responses/MethodNotAllowed'
        '406':
          $ref: '#/components/responses/NotAcceptable'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/UnprocessableEntity'
        '500':
          $ref: '#/components/responses/InternalServerError'
        '503':
          $ref: '#/components/responses/ServiceUnavailable'
        '5XX':
          $ref: '#/components/responses/UnexpectedError'
        default:
          $ref: '#/components/responses/UnexpectedError'

      
components:

  responses:
    BadRequest:
      description: Bad request. The server cannot process the request due to a client error.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ProblemDetails'
            
    Unauthorized:
          description: Authorization information is missing or invalid.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProblemDetails'
    Forbidden:
      description: Not enough permissions to do this operation.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ProblemDetails'
    NotFound:
      description: The specified resource was not found.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ProblemDetails'
    MethodNotAllowed:
      description: This method is not supported for the requested resource.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ProblemDetails'
    NotAcceptable:
      description: The requested resource content cannot match the Accept headers sent in the request.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ProblemDetails'
    Conflict:
      description: The operation cannot be executed currently, due to a conflict with the state of the resource.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ProblemDetails'
    UnprocessableEntity:
      description: The request was well-formed but was unable to be followed due to semantic errors.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ProblemDetails'
    InternalServerError:
      description: Internal server error.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ProblemDetails'
    ServiceUnavailable:
      description: Service temporarily unavailable.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ProblemDetails'
    UnexpectedError:
      description: Unexpected error.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ProblemDetails'
    
            
  # END RESPONSES
  
  schemas:  
  
    ObjectId:
      type: object
      properties:
        id:
          type: string
          format: uuid
          
    AppPkgCreation: 
      description: |
        App Package Information
        Fields (appd) are described
      type: object
      properties:
        appd:
          description: App file descriptor in a compressed format, example .tar.gz
          type: string
          format: binary
      required: 
        - appd

    AppPkgUpdate:
      description: |
        App Package Information
        Fields (id, appd) are described
      type: object
      properties:
        appd:
          description: App file descriptor in a compressed format, example .tar.gz
          type: string
          format: binary
      required: 
        - appd

    AppPkgInstantiation:
      description: |
        App Package Information
        Fields (name, description) are described
      type: object
      properties:
        name:
          description: App Package Name
          type: string
        description:
          description: App Package description
          type: string
      required:
        - name
        - description

    AppPkgInfo:
      description: |
        App Package Information
        Fields (id, name, provider, version, info-name, description) are described
      type: object
      properties:
        id:
          description: App Package identifier
          type: string
        name:
          description: App Package name
          type: string
        provider:
          description: App Package provider
          type: string
        version:
          description: App Package version
          type: string
        info-name:
          description: App Package info-name
          type: string
        description:
          description: App Package description
          type: string
  
      
    ArrayOfAppPkgInfo:
      type: array
      items:
        $ref: '#/components/schemas/AppPkgInfo'
        
    AppInstanceInfo:
      description: |
        App Instance Information
        Fields (id, name, description, operational-status, config-status, details, created-at) are described
      type: object
      properties:
        id:
          description: App Instance identifier
          type: string
        name:
          description: App Instance name
          type: string
        description:
          description: App Instance description
          type: string
        operational-status:
          description: App Instance operational-status
          type: string
        config-status:
          description: App Instance config-status
          type: string
        details:
          description: App Instance details
          type: string
        created-at:
          description: App Instance created-at
          type: string
        
    ArrayOfAppInstancesInfo:
      type: array
      items:
        $ref: '#/components/schemas/AppInstanceInfo'
        
    VimsInfo:
      description: |
        VIM Information
        Fields (id, name) are described
      type: object
      properties:
        id:
          description: VIM identifier
          type: string
        name:
          description: VIM  name
          type: string
    
    ArrayOfVimsInfo:
      type: array
      items:
        $ref: '#/components/schemas/VimsInfo'
    
        
    ProblemDetails:
      type: object
      properties:
        type:
          type: string
          format: uri
        title:
          type: string
        status:
          type: integer
        detail:
          type: string
        instance:
          type: string
          format: uri
      additionalProperties: true
      required:
        - status
        - detail
        
  # END SCHEMAS
  
  requestBodies:
    AppPkgUpdate:
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/AppPkgUpdate'

    AppPkgCreation:
      content:
       application/json:
            schema:
              $ref: '#/components/schemas/AppPkgCreation'
              
    AppPkgInstantiation:
      content:
         application/json:
              schema:
                $ref: '#/components/schemas/AppPkgInstantiation'
                
  # END REQUEST BODIES